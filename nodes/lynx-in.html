<script type="text/javascript">
    RED.nodes.registerType('lynx-in', {
        category: 'IoT Open',
        color: "#12b1be",
        defaults: {
            server: {value: "", type: "lynx-server"},
            installation_id: {value: 0, required: true},
            function_id: {value: 0, required: true},
            function_name: {value: ""},
            topic: {value: ""},
            client_id: {value: 0},
        },
        inputs: 0,
        outputs: 1,
        icon: "lynx-in.png",
        label: function () {
            return this.function_name || "lynx-in"
        },
        oneditprepare: function () {
            let node = this;
            const nodeGen = new NodeGenerics(node)

            if (nodeGen.selectedServer) {
                nodeGen.serverSelected();
            }
        },
    });
</script>

<script type="text/html" data-template-name="lynx-in">
    <div class="form-row">
        <label for="node-input-server"><i class="icon-bookmark"></i> Server</label>
        <input type="text" id="node-input-server">
    </div>
    <div class="form-row">
        <label for="node-input-installation_id"><i class="icon-tag"></i> Installation</label>
        <select id="node-input-installation_id">
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-function_id"><i class="icon-tag"></i> Function</label>
        <select id="node-input-function_id">
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-type"><i class="icon-tag"></i> Topic</label>
        <span id="node-input-type" class="button-group"></span>
    </div>
</script>

<script type="text/html" data-help-name="lynx-in">
    <p>
        A node for receiving data from a function on a Lynx server. In the
        properties: server, installation, function and what topic to get data
        from is set. The data from that function is then sent from the node
        when it arrives.
    </p>
    <h3>
        Output
    </h3>
    <p>
        The output has <code>msg.payload</code> set to the data from Lynx and
        the <code>msg.topic</code> is set to the topic used in Lynx to identify
        the data.
        Some additional data for the selected configuration is also included in
        the output to allow chaining with other Lynx nodes.
    </p>
</script>
